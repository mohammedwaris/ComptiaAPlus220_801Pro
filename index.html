<!DOCTYPE html>
<html>
   <head>
      <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
      <script src="js/jquery-1.11.1.min.js"></script>
      <script type="text/javascript" src="js/jquery.mobile-1.4.2.min.js"></script>
      <script src="js/jquery.timer.js"></script>
      <link rel="stylesheet" href="css/comptia220_801.min.css"/>
      <link rel="stylesheet" href="css/jquery.mobile.icons.min.css"/>
      <link rel="stylesheet" href="css/jquery.mobile.structure-1.4.2.min.css"/>
      <script src="js/questions.js"></script>
      <script src="js/questions-api.js"></script>
      <script src="cordova.js"></script>
      <script type="text/javascript">
         var questions;
         var currentQuestionNumber;
         var currentExam; //1 = Virtual Exam, 2 = Short Exam, 3 = Practice Questions
         var answers;
         var time;
         var timer;

         function hasConnection(){
           		var networkState = navigator.connection.type;
				if(networkState == Connection.NONE){
					return false;
				}
				return true;
         }
         
         document.addEventListener("deviceready", onDeviceReady, false);

         function onDeviceReady(){
         	getRankIfNA();
         	
           if(getPlatform() == 'android'){
             $('#exit-button').removeClass('visibility-hidden');
           } else if(getPlatform() == 'ios'){
           }
           
           document.addEventListener("backbutton", onBackButton, false);

           document.addEventListener("pause", onPause, false);
           document.addEventListener("resume", onResume, false);
           document.addEventListener("online", onOnline, false);
         }

         function onBackButton(){

           currentPage = getCurrentPage();
           if(currentPage == '#main'){
				$('#exit-popup').popup('open');
           }else if(currentPage == '#exam-page'){
               $('#quitExamPopup').popup('open');
           }else if(currentPage == '#practice-questions-page'){
				$.mobile.changePage('#main');
           }else if(currentPage == '#result-page'){
		
           }else if(currentPage == '#answers-page'){

           }else if(currentPage == '#settings-page'){
				$.mobile.changePage('#main');
           }else if(currentPage == '#help'){
				$.mobile.changePage('#main');
           }else if(currentPage == '#top-rankers-page'){
				$.mobile.changePage('#main');
           }
         }

         function onPause(){
           currentPage = getCurrentPage();
           if(currentPage == '#exam-page'){
              timer.pause();
           }
            
         }

         function onResume(){
           currentPage = getCurrentPage();
           if(currentPage == '#exam-page'){
              timer.play(false);
           }
         }

         function onOnline(){
			getRankIfNA();
         }
         
         
         function getRankIfNA(){
			if(localStorage.getItem('user-name')){
              if(localStorage.getItem('user-score')){
                  user_name = localStorage.getItem("user-name");
                  user_email = localStorage.getItem("user-email");
                  user_city = localStorage.getItem("user-city");
                  user_country = localStorage.getItem("user-country");
                  user_uuid = getUUID();
                  user_device = getPlatform();
                  data = '?api_key=abc123';
                  data = data + "&user_name=" + user_name;
                  data = data + "&user_email=" + user_email;
                  data = data + "&user_city=" + user_city;
                  data = data + "&user_country=" + user_country;
                  data = data + "&user_device=" + user_device;
                  data = data + "&user_uuid=" + user_uuid;
                  data = data + "&user_score=" + localStorage.getItem('user-score');
                  data = data + "&time_taken=" + localStorage.getItem('time-taken');
            
                  $.ajax({
                        url: 'http://www.jlojic.com/comptiaaplus200801/getrank' + data,
                        crossDomain: true,
                        dataType: 'jsonp',
                        success: function(response){
                                    $('#user-last-rank').html(response.msg);
                                 },
                        error: function(e){

                        }
                  });
                
              }//end of getItem('user-score')
            }         	
         }// end of getRankIfNA()


         $(document).ready(function(){
         
         	

           $('input[type=checkbox]').click(function(){
             if(currentExam == 1 || currentExam == 2){
                if($('#exam-response-a').is(':checked') == true)
                   a = 'A';
                else
                   a = '';
                if($('#exam-response-b').is(':checked') == true)
                  b = 'B';
                else
                  b = '';
                if($('#exam-response-c').is(':checked') == true)
                  c = 'C';
                else
                   c = ''; 
                if($('#exam-response-d').is(':checked') == true)
                   d = 'D';
                else
                   d = '';
                if($('#exam-response-e').is(':checked') == true)
                   e = 'E';
                else
                   e = '';
                r = a + b + c + d + e;
                answers[currentQuestionNumber-1] = r;
             }

             if(currentExam == 3){
                if($('#practice-questions-response-a').is(':checked') == true)
                   a = 'A';
                else
                   a = '';
                if($('#practice-questions-response-b').is(':checked') == true)
                  b = 'B';
                else
                  b = '';
                if($('#practice-questions-response-c').is(':checked') == true)
                  c = 'C';
                else
                   c = ''; 
                if($('#practice-questions-response-d').is(':checked') == true)
                   d = 'D';
                else
                   d = '';
                if($('#practice-questions-response-e').is(':checked') == true)
                   e = 'E';
                else
                   e = '';
                r = a + b + c + d + e;
                answers[currentQuestionNumber-1] = r;
             }
           });

           $('#practice-questions-toggle-answer').bind('change', function(){
              v = $(this).val();
              
              if(v == 'on'){
                n = currentQuestionNumber - 1;
                d = '';
                if(answers[n] == undefined){
                  d = 'Correct answer is ' + questions[n].answer;
                }else if(questions[n].answer == answers[n]){
                  d = 'You are right, correct answer is ' + questions[n].answer;
                }else if(questions[n].answer != answers[n]){
                  d = 'You are wrong, correct answer is ' + questions[n].answer;
                }
                $('#practice-questions-answer-info').html(d);
                $('#practice-questions-answer-info').removeClass('display-none');
                $('#practice-questions-explanation').removeClass('display-none');
              }else if(v == 'off'){
                $('#practice-questions-answer-info').addClass('display-none');
                $('#practice-questions-explanation').addClass('display-none');
              }
           });


           if(localStorage.getItem('user-score')){
             $('#user-last-result-div').removeClass('display-none');
             $('#user-last-rank').html(localStorage.getItem('user-rank'));
             $('#user-last-score').html(localStorage.getItem('user-score') + '%');
             $('#user-last-time-taken').html(localStorage.getItem('time-taken') + ' min');
             $('#user-last-exam-date').html(localStorage.getItem('exam-date'));
           }
         });// end of document.ready
         
         function gotoExamPage(type){
           if(type == 1) {
              questions = getVirtualExamQuestions();
              currentExam = 1; 
           } else if(type == 2) {
              questions = getShortExamQuestions();
              currentExam = 2; 
           }

           currentQuestionNumber = 1;
           $('#exam-page-timer-text').html('00:00:00');
           $('#exam-page-title').html('1 of ' + questions.length);
           $("#exam-page .question").html('<b>1. </b>' + questions[0].question);
           $("#exam-page .option1").html('<b>A. </b>' + questions[0].option1);
           $("#exam-page .option2").html('<b>B. </b>' + questions[0].option2);
           $("#exam-page .option3").html('<b>C. </b>' + questions[0].option3);
           $("#exam-page .option4").html('<b>D. </b>' + questions[0].option4);
           $("#exam-page .option5").html('<b>E. </b>' + questions[0].option5);
           $.mobile.changePage('#exam-page');
           $('#exam-previous-button').addClass('visibility-hidden');           
           $('#exam-next-button').removeClass('visibility-hidden');   
           $('#exam-ques-num').val('');
  
           answers = new Array();     
           uncheckExamCheckboxes();

           //Start the timer
           if(currentExam == 1)//virtual exam
              time = 90 * 60;// will be in seconds
           else if(currentExam == 2) // Short exam
              time = 10 * 60;

           timer = $.timer(function(){
                    hour = parseInt(time/(60*60));
                    if(hour<=9)
                      hour = '0'+hour;
                    min = parseInt(time%(60*60)/60);
                    if(min<=9)
                      min = '0'+min;
                    if(time%60 == 0){
                      sec = 0;
                    }
                    else
                      sec = sec - 1;
                    if(sec<=9)
                      sec_text = '0'+sec;
                    else
                      sec_text = sec;
                    if(time%60 == 0){
                      sec = 60;
                    } 
                   $('#exam-page-timer-text').html(hour + ":" + min + ":" + sec_text);
                   time--;
                   if(time == -1){
                     $('#timeOverPopup').popup('open');
                     timer.stop();
                   }
           });
           timer.set({time:1000, autostart:true});
         }

         function gotoNextExamQuestion(){
           currentQuestionNumber++;
           n = currentQuestionNumber - 1;
           $('#exam-page-title').html(currentQuestionNumber + ' of ' + questions.length);
           $("#exam-page .question").html('<b>' + (n+1) + '. </b>' + questions[n].question);
           $("#exam-page .option1").html('<b>A. </b>' + questions[n].option1);
           $("#exam-page .option2").html('<b>B. </b>' + questions[n].option2);
           $("#exam-page .option3").html('<b>C. </b>' + questions[n].option3);
           $("#exam-page .option4").html('<b>D. </b>' + questions[n].option4);
           $("#exam-page .option5").html('<b>E. </b>' + questions[n].option5);
           if(currentQuestionNumber == 2){
             $('#exam-previous-button').removeClass('visibility-hidden');
           }
           if(currentQuestionNumber == questions.length){
             $('#exam-next-button').addClass('visibility-hidden');
           }

           uncheckExamCheckboxes();

           if(answers[currentQuestionNumber - 1] != undefined){
             answer = answers[currentQuestionNumber - 1];
             for(i=0;i<answer.length;i++){
               c = answer.charAt(i);
               
               if(c == 'A'){
                  $("#exam-response-a").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'B'){
                  $("#exam-response-b").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'C'){
                  $("#exam-response-c").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'D'){
                  $("#exam-response-d").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'E'){
                  $("#exam-response-e").prop('checked', true).checkboxradio('refresh');
               }
             }
           }

         }

         function gotoPreviousExamQuestion(){
           currentQuestionNumber--;
           n = currentQuestionNumber - 1;
           $('#exam-page-title').html(currentQuestionNumber + ' of ' + questions.length);
           $("#exam-page .question").html('<b>' + (n+1) + '. </b>' + questions[n].question);
           $("#exam-page .option1").html('<b>A. </b>' + questions[n].option1);
           $("#exam-page .option2").html('<b>B. </b>' + questions[n].option2);
           $("#exam-page .option3").html('<b>C. </b>' + questions[n].option3);
           $("#exam-page .option4").html('<b>D. </b>' + questions[n].option4);
           $("#exam-page .option5").html('<b>E. </b>' + questions[n].option5);
           if(currentQuestionNumber == questions.length - 1){
             $('#exam-next-button').removeClass('visibility-hidden');
           }
           if(currentQuestionNumber == 1){
             $('#exam-previous-button').addClass('visibility-hidden');
           }
           
           uncheckExamCheckboxes();
           
           if(answers[currentQuestionNumber - 1] != undefined){
             answer = answers[currentQuestionNumber - 1];
             for(i=0;i<answer.length;i++){
               c = answer.charAt(i);
               
               if(c == 'A'){
                  $("#exam-response-a").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'B'){
                  $("#exam-response-b").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'C'){
                  $("#exam-response-c").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'D'){
                  $("#exam-response-d").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'E'){
                  $("#exam-response-e").prop('checked', true).checkboxradio('refresh');
               }
             }
           }

         }

         function uncheckExamCheckboxes(){
           $("#exam-response-a").attr('checked', false).checkboxradio('refresh');
           $("#exam-response-b").attr('checked', false).checkboxradio('refresh');
           $("#exam-response-c").attr('checked', false).checkboxradio('refresh');
           $("#exam-response-d").attr('checked', false).checkboxradio('refresh');
           $("#exam-response-e").attr('checked', false).checkboxradio('refresh');

         }
       
         function onClickQuitExamButton(){
           $('#quitExamPopup').popup('open');
         }


         function onClickNoButtonQuitExamPopup(){
            $('#quitExamPopup').popup('close')
         }

         function onClickYesButtonQuitExamPopup(){
            timer.stop();
            $('#quitExamPopup').popup('close')
            $.mobile.changePage('#main');
         }


         function onClickShowExamResultButton(){
           $('#showExamResultPopup').popup('open');
         }

         function onClickNoButtonShowExamResultPopup(){
            $('#showExamResultPopup').popup('close')
         }

         function onClickYesButtonShowExamResultPopup(){
            timer.stop();
            $('#showExamResultPopup').popup('close')
            gotoExamResultPage();
         }

         function gotoExamResultPage(){
            correct = 0;
            total_ques = questions.length;
            for(i=0;i<questions.length;i++){
              if(questions[i].answer == answers[i]){
                correct++;
              }
            }

            if(currentExam == 1){
              time_taken = (90*60) - time;
            }else if(currentExam == 2){
              time_taken = (12*60) - time;
            }

            time_taken = (time_taken/60).toFixed(2);

            per = ((correct/total_ques)*100).toFixed(2);
            d = '<table class="result-table" style="width:100%;">' + 
                   '<tr>' + 
                      '<td>' + '<b>Total Questions</b>' + '</td>' +
                      '<td>' + total_ques + '</td>' +  
                   '</tr>' +
                   '<tr>' + 
                      '<td>' + '<b>Correct Answers</b>' + '</td>' +
                      '<td>' + correct + '</td>' +  
                   '</tr>' +
                   '<tr>' + 
                      '<td>' + '<b>Time Taken</b>' + '</td>' +
                      '<td>' + time_taken + ' min </td>' +  
                   '</tr>' +
                 '</table>';
                  
            $('#virtual-exam-result-stats').html(d);
            $('#result-inner-bar').css('width', per + '%');
            $('#result-per-text').html('Score: ' + per + '%');

            dt = new Date();
            dt_str = dt.getDate() + "-" + getMonthString(dt.getMonth()) + "-" + dt.getFullYear();

            $('#virtual-exam-rank').html('');
            if(currentExam == 1){ //if exam is a virtual exam then only get the rank
               if(localStorage.getItem("user-name")){
                  user_name = localStorage.getItem("user-name");
                  user_email = localStorage.getItem("user-email");
                  user_city = localStorage.getItem("user-city");
                  user_country = localStorage.getItem("user-country");
                  user_uuid = getUUID();
                  user_device = getPlatform();
                  data = '?api_key=abc123';
                  data = data + "&user_name=" + user_name;
                  data = data + "&user_email=" + user_email;
                  data = data + "&user_city=" + user_city;
                  data = data + "&user_country=" + user_country;
                  data = data + "&user_device=" + user_device;
                  data = data + "&user_uuid=" + user_uuid;
                  data = data + "&user_score=" + per;
                  data = data + "&time_taken=" + time_taken;

                  d = '<p>Your rank</p>';
                  d = d + '<h3>Retrieving...please wait.</h3>';             
                  $('#virtual-exam-rank').html(d);
                  $.ajax({
                        url: 'http://www.jlojic.com/comptiaaplus220801/getrank' + data,
                        crossDomain: true,
                        dataType: 'jsonp',
                        success: function(response){
                                    localStorage.setItem('user-score', per);
                                    localStorage.setItem('user-rank', response.msg);
                                    localStorage.setItem('time-taken', time_taken);
                                    localStorage.setItem('exam-date', dt_str); 
                                    d = '<p>Your rank</p>';
                                    d = d + '<h3>' + response.msg + '</h3>';
                                    $('#virtual-exam-rank').html(d);
                                    $('#user-last-rank').html(response.msg);
                                    $('#user-last-score').html(per + '%');
                                    $('#user-last-time-taken').html(time_taken + ' min');
                                    $('#user-last-exam-date').html(dt_str);
                                    $('#user-last-result-div').removeClass('display-none');
                                 },
                        error: function(e){
                                    localStorage.setItem('user-score', per);
                                    localStorage.setItem('user-rank', '-');
                                    localStorage.setItem('time-taken', time_taken);
                                    localStorage.setItem('exam-date', dt_str); 
                                    $('#user-last-rank').html('-');
                                    $('#user-last-score').html(per + '%');
                                    $('#user-last-time-taken').html(time_taken + ' min');
                                    $('#user-last-exam-date').html(dt_str);
                                    $('#user-last-result-div').removeClass('display-none');
                        }
                  });
               }else{ //localStorage else part
                  localStorage.setItem('user-score', per);
                  localStorage.setItem('user-rank', '-');
                  localStorage.setItem('time-taken', time_taken);
                  localStorage.setItem('exam-date', dt_str); 
                  $('#user-last-rank').html('-');
                  $('#user-last-score').html(per + '%');
                  $('#user-last-time-taken').html(time_taken + ' min');
                  $('#user-last-exam-date').html(dt_str);
                  $('#user-last-result-div').removeClass('display-none');
               }
            }

            $.mobile.changePage('#result-page');
         }
 
         function getMonthString(m){
           m++;
           if(m == 1){
             str = 'Jan';
           }else if(m == 2){
             str = 'Feb';
           }else if(m == 3){
             str = 'Mar';
           }else if(m == 4){
             str = 'Apr';
           }else if(m == 5){
             str = 'May';
           }else if(m == 6){
             str = 'Jun';
           }else if(m == 7){
             str = 'Jul';
           }else if(m == 8){
             str = 'Aug';
           }else if(m == 9){
             str = 'Sep';
           }else if(m == 10){
             str = 'Oct';
           }else if(m == 11){
             str = 'Nov';
           }else if(m == 12){
             str = 'Dec';
           }

           return str;
         }

         function gotoAnswersPage(){
            data = '';
            correct_str = '';
            answer_right = -1;
            for(i=0;i<questions.length;i++){
              
              d = '<b>' + (i+1) + '. </b>' + questions[i].question;
              d = d + '<b>A. </b>' + questions[i].option1 + '<br/>';
              d = d + '<b>B. </b>' + questions[i].option2 + '<br/>';
              d = d + '<b>C. </b>' + questions[i].option3 + '<br/>';
              d = d + '<b>D. </b>' + questions[i].option4 + '<br/>';
              d = d + '<b>E. </b>' + questions[i].option5 + '<br/><br/>';
              correct_str = questions[i].answer;

                 /*for(j=0;j<questions[i].answer.length;j++){
                    str = questions[i].answer.charAt(j);
                    correct_str = correct_str + str;
                
                    if(questions[i].answer.length == 1){
                    }else if(j < questions[i].answer.length - 1) {
                       correct_str = correct_str + ', ';
                    }else{
                       correct_str = correct_str + ' and ';
                    }
                }*/
     
              if(answers[i] == undefined){
                 d = d + '<span style="font-weight:bold">You have answered NONE</span><br/><br/>';
                 d = d + 'Correct answer is ' + correct_str;
                 st='style=""';
              }else if(questions[i].answer == answers[i]){
                 d = d + '<b>You have answered ' + answers[i] + '</b><br/><br/>';
                 d = d + '<span style="color:green;font-weight:bold;">You are right</span>' + ', correct answer is ' + correct_str;
                 st='style="background-color:green;"';
              }else{
                 d = d + '<b>You have answered ' + answers[i] + '</b><br/><br/>';
                 d = d + '<span style="color:red;font-weight:bold;">You are wrong</span>' + ', correct answer is ' + correct_str;
                 st='style="background-color:#FF9966;"';
              }

              d = '<div>' + d + '</div>';
                          
    
              if(i < questions.length - 1)
                 d = d + '<hr/>';

              
              data = data + d;
            }// end for i
            $('#answers-page-content').html(data);
            $.mobile.changePage('#answers-page');
         }

         function jumpToVirtualExamQuestion(){
           num = $('#exam-ques-num').val();

              n = parseInt(num);
              if(n == NaN){
                 alert('Invalid number');
              }else{
                 if(n >= 1 && n <= questions.length)
                    gotoExamQuestion(n);
                 else
                    alert('Unknown number');
              }


         }

         function gotoExamQuestion(num){
           currentQuestionNumber = num;
           n = currentQuestionNumber - 1;
           $('#exam-page-title').html(currentQuestionNumber + ' of ' + questions.length);
           $("#exam-page .question").html('<b>' + (n+1) + '. </b>' + questions[n].question);
           $("#exam-page .option1").html('<b>A. </b>' + questions[n].option1);
           $("#exam-page .option2").html('<b>B. </b>' + questions[n].option2);
           $("#exam-page .option3").html('<b>C. </b>' + questions[n].option3);
           $("#exam-page .option4").html('<b>D. </b>' + questions[n].option4);
           $("#exam-page .option5").html('<b>E. </b>' + questions[n].option5);
           if(currentQuestionNumber == 2){
             $('#exam-previous-button').removeClass('visibility-hidden');
           }

           if(currentQuestionNumber > 1){
              $('#exam-previous-button').removeClass('visibility-hidden');
           }else if(currentQuestionNumber == 1){
              $('#exam-previous-button').addClass('visibility-hidden');
           }

           if(currentQuestionNumber < questions.length){
             $('#exam-next-button').removeClass('visibility-hidden');
           }else if(currentQuestionNumber == questions.length){
             $('#exam-next-button').addClass('visibility-hidden');
           }

           uncheckExamCheckboxes();


           if(answers[currentQuestionNumber - 1] != ""){
             answer = answers[currentQuestionNumber - 1];
             for(i=0;i<answer.length;i++){
               c = answer.charAt(i);
               
               if(c == 'A'){
                  $("#exam-response-a").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'B'){
                  $("#exam-response-b").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'C'){
                  $("#exam-response-c").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'D'){
                  $("#exam-response-d").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'E'){
                  $("#exam-response-e").prop('checked', true).checkboxradio('refresh');
               }
             }
           }  
         }


         function getPlatform(){
           platform = 'Unknown';
           if(device.platform == "Android"){
              platform = 'android';
           }else if(device.platform == "iOS"){
              platform = 'ios';
           }

           //platform = 'android';
           //platform = 'ios';
           //platform = 'blackberry';
           //platform = 'windowsphone';

           return platform;
         }

         function onClickExitButton(){ 
           $('#exit-popup').popup('open');
         }

         function onClickYesButtonExitPopup(){
           navigator.app.exitApp();
         }

         function onClickNoButtonExitPopup(){
           $('#exit-popup').popup('close');           
         }

         function gotoPracticeQuestionsPage(){
           currentExam = 3;
           questions = getPracticeQuestions();
           currentQuestionNumber = 1;
           $('#practice-questions-page-title').html('1 of ' + questions.length);
           $("#practice-questions-page .question").html('<b>1. </b>' + questions[0].question);
           $("#practice-questions-page .option1").html('<b>A. </b>' + questions[0].option1);
           $("#practice-questions-page .option2").html('<b>B. </b>' + questions[0].option2);
           $("#practice-questions-page .option3").html('<b>C. </b>' + questions[0].option3);
           $("#practice-questions-page .option4").html('<b>D. </b>' + questions[0].option4);
           $("#practice-questions-page .option5").html('<b>E. </b>' + questions[0].option5);
           $('#practice-questions-explanation').html(questions[0].explanation);

           $('#practice-questions-previous-button').addClass('visibility-hidden');           
           $('#practice-questions-next-button').removeClass('visibility-hidden');   
           $('#practice-questions-ques-num').val('');
           
           try{
           		$("#practice-questions-toggle-answer").val('off').slider('refresh');
           }catch(e){}
           $('#practice-questions-answer-info').addClass('display-none');
           $('#practice-questions-explanation').addClass('display-none');
  
           answers = new Array();     
	   		$.mobile.changePage('#practice-questions-page');
           uncheckPracticeQuestionsCheckboxes();


           
         }

         function uncheckPracticeQuestionsCheckboxes(){
           $("#practice-questions-response-a").attr('checked', false).checkboxradio('refresh');
           $("#practice-questions-response-b").attr('checked', false).checkboxradio('refresh');
           $("#practice-questions-response-c").attr('checked', false).checkboxradio('refresh');
           $("#practice-questions-response-d").attr('checked', false).checkboxradio('refresh');
           $("#practice-questions-response-e").attr('checked', false).checkboxradio('refresh');

         }

         function gotoNextPracticeQuestion(){
            currentQuestionNumber++;
            seekPracticeQuestion(currentQuestionNumber);
         }

         function gotoPreviousPracticeQuestion(){
            currentQuestionNumber--;
            seekPracticeQuestion(currentQuestionNumber);
         }

         function seekPracticeQuestion(num){
           currentQuestionNumber = num;
           n = currentQuestionNumber - 1;
           $('#practice-questions-page-title').html(currentQuestionNumber + ' of ' + questions.length);
           $("#practice-questions-page .question").html('<b>' + (n+1) + '. </b>' + questions[n].question);
           $("#practice-questions-page .option1").html('<b>A. </b>' + questions[n].option1);
           $("#practice-questions-page .option2").html('<b>B. </b>' + questions[n].option2);
           $("#practice-questions-page .option3").html('<b>C. </b>' + questions[n].option3);
           $("#practice-questions-page .option4").html('<b>D. </b>' + questions[n].option4);
           $("#practice-questions-page .option5").html('<b>E. </b>' + questions[n].option5);
           $('#practice-questions-explanation').html(questions[n].explanation);

           if(currentQuestionNumber == 2){
             $('#practice-questions-previous-button').removeClass('visibility-hidden');
           }
           if(currentQuestionNumber > 1){
              $('#practice-questions-previous-button').removeClass('visibility-hidden');
           }else if(currentQuestionNumber == 1){
              $('#practice-questions-previous-button').addClass('visibility-hidden');
           }

           if(currentQuestionNumber < questions.length){
             $('#practice-questions-next-button').removeClass('visibility-hidden');
           }else if(currentQuestionNumber == questions.length){
             $('#practice-questions-next-button').addClass('visibility-hidden');
           }

          
           uncheckPracticeQuestionsCheckboxes();
           $("#practice-questions-toggle-answer").val('off').slider('refresh');
           $('#practice-questions-answer-info').addClass('display-none');
           $('#practice-questions-explanation').addClass('display-none');

           
           if(answers[currentQuestionNumber - 1] != ""){
             answer = answers[currentQuestionNumber - 1];
             for(i=0;i<answer.length;i++){
               c = answer.charAt(i);
               
               if(c == 'A'){
                  $("#practice-questions-response-a").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'B'){
                  $("#practice-questions-response-b").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'C'){
                  $("#practice-questions-response-c").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'D'){
                  $("#practice-questions-response-d").prop('checked', true).checkboxradio('refresh');
               }else if(c == 'E'){
                  $("#practice-questions-response-e").prop('checked', true).checkboxradio('refresh');
               }
             }// end for

           }//end if
        }

        function jumpToPracticeQuestionsQuestion() {
           num = $('#practice-questions-ques-num').val();

              n = parseInt(num);
              if(n == NaN){
                 alert('Invalid number');
              }else{
                 if(n >= 1 && n <= questions.length)
                    seekPracticeQuestion(n);
                 else
                    alert('Unknown number');
              }
        }

        function gotoSettingsPage(){
           if(localStorage.getItem("user-name")){
              user_name = localStorage.getItem("user-name");
              user_email = localStorage.getItem("user-email");
              user_city = localStorage.getItem("user-city");
              user_country = localStorage.getItem("user-country");
              $('#user-name').val(user_name);
              $('#user-email').val(user_email);
              $('#user-city').val(user_city);
              $('#user-country').val(user_country);
           }
           $.mobile.changePage('#settings-page');
        }

        function saveUserSettings(){
          user_name = $('#user-name').val();
          user_email = $('#user-email').val();
          user_city = $('#user-city').val();
          user_country = $('#user-country').val();
          if(user_name == "" || user_email == "" || user_city == "" || user_country == ""){
            $('#missingUserDetailsPopup').popup('open');
          }else{

             user_uuid = getUUID();
             user_device = getPlatform();
             data = '?api_key=abc123&user_name=' + user_name;
             data = data + "&user_email=" + user_email;
             data = data + "&user_city=" + user_city;
             data = data + "&user_country=" + user_country;
             data = data + "&user_uuid=" + user_uuid;
             data = data + "&user_device=" + user_device;
             $('#user-details-save-confirmation-popup').popup('open');
             $.ajax({url: 'http://www.jlojic.com/comptiaaplus220801/saveuser' + data,
                     crossDomain: true,
                     dataType: 'jsonp',
                     success: function(response){
                       if(response.msg == "success"){
                         localStorage.setItem("user-name", user_name);
                         localStorage.setItem("user-email", user_email);
                         localStorage.setItem("user-city", user_city);
                         localStorage.setItem("user-country", user_country);
                       }
                       $('#user-details-save-confirmation-popup').popup('close');
                     },
                     error: function(e){ 
                       $('#user-details-save-confirmation-popup').popup('close');
                     }
                   });
          

          }
        }

        function gotoTopRankersPage(){
          $('#top-rankers-page-content').html('<p style="text-align:center;">Retrieving list...</p>');
          $.ajax({
		url: 'http://www.jlojic.com/comptiaaplus220801/gettoprankers?api_key=abc123&limit=10',
                crossDomain: true,
                dataType: 'jsonp',
                success: function(response){
                    data = '<table border="1" class="top-rankers-table">';
                    data = data + '<tr><th>Rank</th><th colspan="2">Ranker Info</th></tr>';
                    for(i=0;i<response.length;i++){
                       data = data + '<tr>';
                       data = data + '<td rowspan="5" style="text-align: center;">' + (i+1) + '</td>';
                       data = data + '<td style="background-color:#98FB98"><b>Name</b></td>';
                       data = data + '<td style="background-color:#98FB98">' + response[i].user_name + '</td>';
                       data = data + '</tr>';
                       data = data + '<tr>';
                       data = data + '<td><b>Score</b></td>';
                       data = data + '<td>' + response[i].user_score + '</td>';
                       data = data + '</tr>';
                       data = data + '<tr>';
                       data = data + '<td><b>Time Taken</b></td>';
                       data = data + '<td>' + response[i].time_taken + '</td>';
                       data = data + '</tr>';
                       data = data + '<tr>';
                       data = data + '<td><b>Location</b></td>';
                       data = data + '<td>' + response[i].user_city + ', ' + response[i].user_country + '</td>';
                       data = data + '</tr>';
                       data = data + '<tr>';
                       data = data + '<td><b>Device</b></td>';
                       data = data + '<td>' + response[i].user_device + '</td>';
                       data = data + '</tr>';
                    }
                    data = data + '</table>';
                    $('#top-rankers-page-content').html(data);
                },
                error: function(e){
                  
                }

	  });
          $.mobile.changePage('#top-rankers-page');
        }


        function getUUID(){
          return device.uuid;
        }

        function onClickOkButtonMissingUserDetailsPopup(){
          $('#missingUserDetailsPopup').popup('close');
        }

        function getCurrentPage(){
          id = $.mobile.activePage.attr('id');
          return '#' + id;
        }

      </script>
      <style>
         .visibility-hidden{
            visibility: hidden;
         }
         #practice-questions-toggle-answer-container .ui-slider-switch { 
            width: 250px; 
         }
         .display-none{
            display:none;
         }
         .result-table{
            border-collapse: collapse;
         }
         .result-table td{
            padding: 5px;
            border: 1px solid #DF5E58;
         }
         .top-rankers-table{
            width: 100%;
            border-collapse: collapse;
         }
         .top-rankers-table td, .top-rankers-table th{
            padding: 5px;
            border: 1px solid #DF5E58;
         }
         .top-rankers-table .end-tr{
            border-bottom:2px solid #DF5E58;
         }
         .top-rankers-table th{
            background-color: #F18C79;
         }
         #user-last-result-div{
            border: 0px solid;
            border-radius: 10px;
         }
         .last-result-table{
            width: 100%;
            border-collapse: collapse;
         }
         .last-result-table td, .last-result-table th{
            border: 1px solid #DF5E58;
            border-radius: 0px;
         }

         .last-result-table th{
            background-color: #F18C79;
         }

         #result-outer-bar{
          width: 100%;
          height: 20px;
          background-color: #000000;
         }
         #result-inner-bar{
          height: 100%;
          background-color: green;
         }

      </style>
   </head>
   <body>
      <div data-role="page" id="main">
         <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>Comptia A+ 220-801</h1>
            <a href="javascript: onClickExitButton()" data-role="button" id="exit-button" class="visibility-hidden">Exit</a> 
            <div data-role="popup" data-history="false" id="exit-popup" data-position-to="window"  data-dismissible="false">
	       <p>Are you sure want to exit<p>
               <fieldset class="ui-grid-a">
	          <div class="ui-block-a"><a href="javascript: onClickYesButtonExitPopup()" data-role="button">Yes</a></div>
	          <div class="ui-block-b"><a href="javascript: onClickNoButtonExitPopup()" data-role="button">No</a></div>	   
               </fieldset>
            </div>
         </div>     
         <div data-role="content">
            <div id="user-last-result-div" class="display-none">
               <table class="last-result-table">
                  <tr>
                     <th colspan="3">Last Result</th>
                  </tr>
                  <tr>
                     <th>Rank</th>
                     <th colspan="2">&nbsp;</th>
                  </tr>
                  <tr>
                     <td rowspan="3"><p style="text-align:center;" id="user-last-rank">&nbsp;</p></td>
                     <td><b>Score</b></td>                     
                     <td><span id="user-last-score">&nbsp;</span></td>                     
                  </tr>
                  <tr>
                     <td><b>Time Taken</b></td>                     
                     <td><span id="user-last-time-taken">&nbsp;</span></td>                     
                  </tr>
                  <tr>
                     <td><b>Date</b></td>                     
                     <td><span id="user-last-exam-date"></span></td>                     
                  </tr>
               </table>
            </div>
            <ul data-role="listview" data-inset="true">
               <li><a href="javascript: gotoExamPage(1)">Virtual Exam</a></li>
               <li><a href="javascript: gotoExamPage(2)">Short Exam</a></li>
               <li><a href="javascript: gotoPracticeQuestionsPage()">Practice Questions</a></li>
               <li><a href="javascript: gotoTopRankersPage()">Top Rankers</a></li>
               <li><a href="javascript: gotoSettingsPage()">Settings</a></li>
               <li><a href="#help">Help</a></li>
            </ul>
         </div>
      </div>

      <!-- Virtual Exam and Short Exam-->
      <div id="exam-page" data-role="page">
         <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1 id="exam-page-title">Virtual Exam</h1>
            <a href="javascript: onClickQuitExamButton()" data-role="button">Quit</a> 
            <a href="javascript: onClickShowExamResultButton()" data-role="button">Show Result</a> 
            <div data-role="navbar" id="goto-div">
               <div class="ui-grid-b">
                  <div class="ui-block-a"><p style="text-align:right;padding-right:10px;">Ques</p></div>
                  <div class="ui-block-b"><input type="number" id="exam-ques-num"/></div>
                  <div class="ui-block-c"><a href="javascript: jumpToVirtualExamQuestion()" data-role="button">Go</a></div>
               </div>
            </div><!-- /navbar -->
            <div data-role="popup" data-history="false" id="quitExamPopup" data-position-to="window"  data-dismissible="false">
	       <p>Are you sure want to quit<p>
               <fieldset class="ui-grid-a">
	          <div class="ui-block-a"><a href="javascript: onClickYesButtonQuitExamPopup()" data-role="button">Yes</a></div>
	          <div class="ui-block-b"><a href="javascript: onClickNoButtonQuitExamPopup()" data-role="button">No</a></div>	   
               </fieldset>
            </div>
            <div data-role="popup" data-history="false" id="showExamResultPopup" data-position-to="window"  data-dismissible="false">
	       <p>Have you completed the exam<p>
               <fieldset class="ui-grid-a">
	          <div class="ui-block-a"><a href="javascript: onClickYesButtonShowExamResultPopup()" data-role="button">Yes</a></div>
	          <div class="ui-block-b"><a href="javascript: onClickNoButtonShowExamResultPopup()" data-role="button">No</a></div>	   
               </fieldset>
            </div>
            <div data-role="popup" data-history="false" id="timeOverPopup" data-position-to="window"  data-dismissible="false">
	       <p style="text-align:center;">Time Over<p>
               <a href="javascript: gotoExamResultPage();" data-role="button">Okay</a>
            </div>
         </div><!-- end of header -->
         <div data-role="content">
            <div class="question"></div>
            <div class="option1"></div>
            <div class="option2"></div>
            <div class="option3"></div>
            <div class="option4"></div>
            <div data-role="fieldcontain">
               <fieldset data-role="controlgroup" data-type="horizontal">
	          <input type="checkbox" name="examResponseA" id="exam-response-a" value="A"/>
	          <label for="exam-response-a">A</label>
                  <input type="checkbox" name="examResponseB" id="exam-response-b" value="B"/>
	          <label for="exam-response-b">B</label>
                  <input type="checkbox" name="examResponseC" id="exam-response-c" value="C"/>
	          <label for="exam-response-c">C</label>
                  <input type="checkbox" name="examResponseD" id="exam-response-d" value="D"/>
	          <label for="exam-response-d">D</label>
               </fieldset>
            </div>
         </div>
         <div data-role="footer" class="ui-bar" data-position="fixed" data-tap-toggle="false">
            <h1>
               <a href="javascript: gotoPreviousExamQuestion()" data-role="button" class="" id="exam-previous-button">Prev</a>
               <span id="exam-page-timer-text">00:00:00</span>
               <a href="javascript: gotoNextExamQuestion()" data-role="button" id="exam-next-button">Next</a>
            </h1>
         </div>
      </div>

      <!-- Practice questions page -->
      <div id="practice-questions-page" data-role="page">
         <div data-role="header" data-tap-toggle="false" data-position="fixed">
            <h1 id="practice-questions-page-title">Practice Questions</h1>
            <a href="#main" data-role="button">Back</a> 
            <div data-role="navbar" id="practice-questions-goto-div">
               <div class="ui-grid-b">
                  <div class="ui-block-a"><p style="text-align:right;padding-right:10px;">Ques</p></div>
                  <div class="ui-block-b"><input type="number" id="practice-questions-ques-num"/></div>
                  <div class="ui-block-c"><a href="javascript: jumpToPracticeQuestionsQuestion()" data-role="button">Go</a></div>
               </div>
            </div><!-- /navbar -->
         </div>
         <div data-role="content">
            <div class="question"></div>
            <div class="option1"></div>
            <div class="option2"></div>
            <div class="option3"></div>
            <div class="option4"></div>
            <div data-role="fieldcontain">
               <fieldset data-role="controlgroup" data-type="horizontal">
	          <input type="checkbox" name="practiceQuestionsResponseA" id="practice-questions-response-a" value="A"/>
	          <label for="practice-questions-response-a">A</label>
                  <input type="checkbox" name="practiceQuestionsResponseB" id="practice-questions-response-b" value="B"/>
	          <label for="practice-questions-response-b">B</label>
                  <input type="checkbox" name="practiceQuestionsResponseC" id="practice-questions-response-c" value="C"/>
	          <label for="practice-questions-response-c">C</label>
                  <input type="checkbox" name="practiceQuestionsResponseD" id="practice-questions-response-d" value="D"/>
	          <label for="practice-questions-response-d">D</label>
               </fieldset>
            </div>

            <div id="practice-questions-toggle-answer-container">
               <label for="practice-questions-toggle-answer"></label>
               <select name="flip-1" id="practice-questions-toggle-answer" data-role="slider">
	          <option value="off">Show answer/explanation</option>
	          <option value="on">Hide answer/explanation</option>
               </select> 
            </div>
            <div id="practice-questions-answer-info" class="display-none"></div>
            <br/>
            <div id="practice-questions-explanation" class="display-none"></div>
           
         </div>
         <div data-role="footer" class="ui-bar" data-position="fixed" data-tap-toggle="false">
		<h1>
               <a href="javascript: gotoPreviousPracticeQuestion()" data-role="button" class="" id="practice-questions-previous-button">Prev</a>
               
               <a href="javascript: gotoNextPracticeQuestion()" data-role="button" id="practice-questions-next-button">Next</a>
		</h1>

         </div>

      </div>

      <!-- TOp rankers page -->
      <div id="top-rankers-page" data-role="page">
         <div data-role="header" data-tap-toggle="false" data-position="fixed">
            <h1>Top Rankers</h1>
            <a href="#main" data-role="button">Back</a> 
         </div>
         <div data-role="content" id="top-rankers-page-content">
         </div>
      </div>

      <!-- Settings page -->
      <div id="settings-page" data-role="page">
         <div data-role="header" data-tap-toggle="false" data-position="fixed">
            <h1>Settings</h1>
            <a href="#main" data-role="button">Back</a> 
            <div data-role="popup" data-history="false" id="missingUserDetailsPopup" data-position-to="window"  data-dismissible="false">
	       <p>Please fill in all the details<p>
               <p style="text-align:center;">
                  <a href="javascript: onClickOkButtonMissingUserDetailsPopup()" data-role="button" data-inline="true">Okay</a>
               </p>
            </div>
            <div data-role="popup" data-history="false" id="user-details-save-confirmation-popup" data-position-to="window"  data-dismissible="false">
	       <p class="">Saving...Please wait<p>
            </div>
         </div>
         <div data-role="content">
            <p style="font-weight:bold;">Please fill in the below details to know your rank.</p>
            <label for="user-name">Name</label>
            <input type="text" name="username" id="user-name" value=""  />
            <label for="user-email">Email</label>
            <input type="text" name="useremail" id="user-email" value=""  />
            <label for="user-city">City</label>
            <input type="text" name="usercity" id="user-city" value=""  />
            <label for="user-country">Country</label>
            <input type="text" name="country" id="user-country" value=""  />
            <p style="text-align:center;">
               <a href="javascript: saveUserSettings()" data-role="button" data-inline="true">Save</a>
            </p>
         </div>
      </div>

      <!-- Help page -->
      <div id="help" data-role="page">
         <div data-role="header" data-tap-toggle="false" data-position="fixed">
            <h1>Help</h1>
            <a href="#main" data-role="button">Back</a> 
         </div>
         <div data-role="content">
            <h3>Virtual Exam</h3>
            <ul>
               <li>You will get 90 questions to solve in 90 minutes.</li>
               <li>Passing score is 75%, Try to score as much as possible.</li>
               <li>You can quit the exam anytime with the QUIT button</li>
               <li>After completing the exam press the SHOW RESULT button to view your score.</li>
               <li>You can also view your rank after completing the exam.</li>
            </ul>
            <h3>Short Exam</h3>
            <ul>
               <li>You will get 10 questions to solve in 10 minutes.</li>
               <li>You can quit the exam anytime with the QUIT button</li>
               <li>After completing the exam press the SHOW RESULT button to view your score.</li>
            </ul>
            <h3>Practice Questions</h3>
            <ul>
               <li>Question to practising for Comptia A+ 220-801 certification.</li>
               <li>Slider at the bottom of the question to check your answers.</li>
            </ul>
            <h3>Top Rankers</h3>
            <ul>
               <li>List of top rankers.</li>
            </ul>
            <h3>Settings</h3>
            <ul>
               <li>Fill and submit your details in this section to know your rank when you complete the virtual exam.</li>
               <li>Rank is only available for virtual exam and not for short exam.</li>
            </ul>
         </div>
      </div>

      <!-- Result page -->
      <div id="result-page" data-role="page">
         <div data-role="header" data-tap-toggle="false" data-position="fixed">
            <h1>Result</h1>
            <a href="#main" data-role="button">Okay</a>
            <a href="javascript: gotoAnswersPage()" data-role="button">Show Answers</a> 
         </div>
         <div data-role="content" id="result-page-content">
            <div id="result-outer-bar">
               <div id="result-inner-bar">
               </div>
            </div>
            <div id="result-per-text" style="font-weight:bold;text-align:center;width:100%;"></div>
            <br/>
            <div id="virtual-exam-result-stats"></div>
            <div id="virtual-exam-rank" style="text-align:center;"></div>
         </div>
      </div>

      <!-- Answers page -->
      <div id="answers-page" data-role="page">
         <div data-role="header" data-position="fixed" data-tap-toggle="false">
            <h1>Answers</h1>
            <a href="#result-page" data-role="button">Back</a>
            <a href="#main" data-role="button">Okay</a> 
         </div>
         <div data-role="content" id="answers-page-content">
         </div>
      </div>


   </body>
</html>